{"ast":null,"code":"import{always,block,call,clockRunning,cond,set,startClock,stopClock}from\"../base\";import Clock from\"../core/AnimatedClock\";import{evaluateOnce}from\"../derived/evaluateOnce\";function createOldAnimationObject(node,animationStateDefaults,value,config){var newClock=new Clock();var currentState=animationStateDefaults();var alwaysNode;var isStarted=false;var isDone=false;var wasStopped=false;var animationCallback;var animation={start:function start(currentAnimationCallback){animationCallback=currentAnimationCallback;if(isStarted){animationCallback&&animationCallback({finished:false});return;}if(isDone){console.warn('Animation has been finished before');return;}if(!value.isNativelyInitialized()){return;}isStarted=true;evaluateOnce(set(currentState.position,value),currentState.position,function(){alwaysNode=always(set(value,block([cond(clockRunning(newClock),0,startClock(newClock)),node(newClock,currentState,config),cond(currentState.finished,[call([],function(){isStarted=false;if(!wasStopped){isDone=true;}value.__detachAnimation(animation);isDone=true;if(!wasStopped){wasStopped=false;}}),stopClock(newClock)]),currentState.position])));value.__attachAnimation(animation);alwaysNode.__addChild(value);});},__detach:function __detach(){animationCallback&&animationCallback({finished:isDone});animationCallback=null;value.__initialized&&alwaysNode.__removeChild(value);},stop:function stop(){if(isDone){console.warn('Calling stop has no effect as the animation has already completed');return;}if(!isStarted){console.warn(\"Calling stop has no effect as the animation hasn't been started\");return;}wasStopped=true;evaluateOnce(set(currentState.finished,1),currentState.finished);},__stopImmediately_testOnly:function __stopImmediately_testOnly(result){animation.stop();isDone=result;value.__detachAnimation(animation);}};return animation;}export default function backwardsCompatibleAnimWrapper(node,animationStateDefaults){return function(clock,state,config){if(config!==undefined){return node(clock,state,config);}return createOldAnimationObject(node,animationStateDefaults,clock,state);};}","map":{"version":3,"names":["always","block","call","clockRunning","cond","set","startClock","stopClock","Clock","evaluateOnce","createOldAnimationObject","node","animationStateDefaults","value","config","newClock","currentState","alwaysNode","isStarted","isDone","wasStopped","animationCallback","animation","start","currentAnimationCallback","finished","console","warn","isNativelyInitialized","position","__detachAnimation","__attachAnimation","__addChild","__detach","__initialized","__removeChild","stop","__stopImmediately_testOnly","result","backwardsCompatibleAnimWrapper","clock","state","undefined"],"sources":["/Users/pg328/Projects/friendzone/node_modules/react-native-reanimated/lib/reanimated1/animations/backwardCompatibleAnimWrapper.js"],"sourcesContent":["import {\n  always,\n  block,\n  call,\n  clockRunning,\n  cond,\n  set,\n  startClock,\n  stopClock,\n} from '../base';\nimport Clock from '../core/AnimatedClock';\nimport { evaluateOnce } from '../derived/evaluateOnce';\n\nfunction createOldAnimationObject(node, animationStateDefaults, value, config) {\n  const newClock = new Clock();\n  const currentState = animationStateDefaults();\n  let alwaysNode;\n  let isStarted = false;\n  let isDone = false;\n  let wasStopped = false;\n  let animationCallback;\n  const animation = {\n    start: (currentAnimationCallback) => {\n      animationCallback = currentAnimationCallback;\n      if (isStarted) {\n        animationCallback && animationCallback({ finished: false });\n        return;\n      }\n      if (isDone) {\n        console.warn('Animation has been finished before');\n        // inconsistent with React Native\n        return;\n      }\n\n      if (!value.isNativelyInitialized()) {\n        return;\n      }\n\n      isStarted = true;\n      evaluateOnce(\n        set(currentState.position, value),\n        currentState.position,\n        () => {\n          alwaysNode = always(\n            set(\n              value,\n              block([\n                cond(clockRunning(newClock), 0, startClock(newClock)),\n                node(newClock, currentState, config),\n                cond(currentState.finished, [\n                  call([], () => {\n                    isStarted = false;\n                    if (!wasStopped) {\n                      isDone = true;\n                    }\n                    value.__detachAnimation(animation);\n                    isDone = true;\n                    if (!wasStopped) {\n                      wasStopped = false;\n                    }\n                  }),\n                  stopClock(newClock),\n                ]),\n                currentState.position,\n              ])\n            )\n          );\n          value.__attachAnimation(animation);\n          alwaysNode.__addChild(value);\n        }\n      );\n    },\n    __detach: () => {\n      animationCallback && animationCallback({ finished: isDone });\n      animationCallback = null;\n      value.__initialized && alwaysNode.__removeChild(value);\n    },\n    stop: () => {\n      if (isDone) {\n        console.warn(\n          'Calling stop has no effect as the animation has already completed'\n        );\n        return;\n      }\n      if (!isStarted) {\n        console.warn(\n          \"Calling stop has no effect as the animation hasn't been started\"\n        );\n        return;\n      }\n      wasStopped = true;\n      evaluateOnce(set(currentState.finished, 1), currentState.finished);\n    },\n    __stopImmediately_testOnly: (result) => {\n      animation.stop();\n      isDone = result;\n      value.__detachAnimation(animation);\n    },\n  };\n  return animation;\n}\n\n/**\n * Depending on the arguments list we either return animation node or return an\n * animation object that is compatible with the original Animated API\n */\nexport default function backwardsCompatibleAnimWrapper(\n  node,\n  animationStateDefaults\n) {\n  return (clock, state, config) => {\n    if (config !== undefined) {\n      return node(clock, state, config);\n    }\n    return createOldAnimationObject(node, animationStateDefaults, clock, state);\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}